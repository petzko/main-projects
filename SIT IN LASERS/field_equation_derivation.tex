%% ****** Start of file apsguide4-1.tex ****** %
%%
%%   This file is part of the APS files in the REVTeX 4.1 distribution.
%%   Version 4.1r of REVTeX, August 2010.
%%
%%   Copyright (c) 2009, 2010 The American Physical Society.
%%
%%   See the REVTeX 4.1 README file for restrictions and more information.
%%
\documentclass[preprint,secnumarabic,amssymb, nobibnotes, aip, prd]{revtex4-1}
%\usepackage{acrofont}%NOTE: Comment out this line for the release version!
\newcommand{\revtex}{REV\TeX\ }
\newcommand{\classoption}[1]{\texttt{#1}}
\newcommand{\macro}[1]{\texttt{\textbackslash#1}}
\newcommand{\m}[1]{\macro{#1}}
\newcommand{\env}[1]{\texttt{#1}}
\setlength{\textheight}{9.5in}


\usepackage{amsmath,amsfonts,amssymb}
\usepackage{graphicx}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}


\usepackage{color}
\usepackage[latin9]{inputenc}
\usepackage{mathrsfs,amsmath}
\usepackage{graphicx}%
\usepackage{float}
\usepackage{amsfonts}%
\usepackage[titletoc]{appendix}
\usepackage{amssymb}
\usepackage{braket}
\usepackage{bm}

\newcommand{\mb}[1]{\bm{#1}}
\usepackage[T1]{fontenc}

\def\Nabla{\bm{\nabla}}
\def\bm{\mathbf}
\def\curl{\Nabla\times}
\def\div{\Nabla\cdot}
\def\lap{\Delta}
\def\vlap{\Delta}
\def\x{\hat{e}_{x}}
\def\y{\hat{e}_{y}}
\def\z{\hat{e}_{z}}
\def\p{\partial}
\def\h{\hat}
\def\h{\hat}
\def\tw{\tilde{\omega}}
\def\gm{\gamma}
\def\om{\omega}
\def\OM{\Omega}
\def\GM{\Gamma}
\def\dw{\delta\omega}
\def\dth{\Delta\theta}
\def\dk{\delta k}
\def\Hdth{\frac{\dth}{2}} %half Delta Theta
\def\P{\hat{\pi}_+}
\def\M{\hat{\pi}_-}

%\usepackage[font=small]{caption}
\newcommand{\includegraphicsXL}[1]{\includegraphics[width = 0.4\textwidth]{#1}}
%\captionsetup{width=.45\textwidth}




\bibliographystyle{ieeetr}
\begin{document}
	
	\section{Derivation of the two level field propagation equations}
	
	Note that, for convenience,  I have changed the notation from the powerpoint slides and used the symbol $f(x,t)$ to denote the electric field \emph{envelope}, whereas the letter $E$ is reserved for the ELECTRIC FILED.
	
	
	For active atoms embedded in a passive medium the total polarization comprises of two terms
	\begin{equation}
	P_{tot} = P+P_0 = P+\epsilon_0\chi_0E_z
	\end{equation}
	where the first term is the polarization contributed by the active atoms and $P_0$ is the background polarization as a linear reaction to the EM field due to the constant background susceptibility $\chi_0$. The background refractive index can be written as 
	$n_{THz}^2 = 1+\chi_0$ which yields the wave equation 
	\begin{align}
	\label{eq:waveqn}
	\underbrace{\left [\frac{c^2}{n_{THz}^2} \frac{\p^2}{\p x^2} -\frac{\p^2}{\p t^2} \right ] E_z}_{LHS} =\overbrace{\frac{1}{\epsilon_0 n_{THz}^2}\frac{\p^2}{\p t^2}P}^{RHS}  
	\end{align}
	
	The incident light is assumed linear polarized in z-direction and slowly varying:
	\begin{equation}
	E_z(x,t) =\frac{1}{2}E(x,t)e^{i(k_0x-\omega_0t)}+c.c.,  
	\end{equation}
	where $E(x,t)$ is the slowly varying envelope, $\omega_0$ is the central frequency and we also \emph{assume} that $k_0=\omega_0 n_{THz}/c$ is the corresponding wave number. 
	The polarization $P$ takes the form 
	\begin{equation}
	P(x,t) =  -N\Gamma\mu (\rho_{12}+\rho_{21}),  
	\end{equation}
	which is obtained by calculating the expectation value of the dipole moment operator in the two level system. $N\Gamma$ is the 
	"effective" active carriers' volume density and $\mu$ is the optical transition's dipole moment (in units of $C\cdot m$). We have taken a minus sign due to the fact that in our convention $\mu = e\bra{2}\hat{z}\ket{1}$, where $e$ is the \emph{positive} elementary charge. 
	
	We decompose $\rho_{21}=\eta_{21}e^{i(k_0x-\omega_0t)}$, perform the differentiation in the wave equation and use that, within the slowly varying envelope approximation (SVEA), it holds
	\begin{align}
	\label{eq:SVEA}
	\left |\frac{\p^2 E}{\p t^2}\right | \ll \omega_0\left|\frac{\p E}{\p t}\right| \quad \text{, } \left |\frac{\p^2 E}{\p x^2}\right | \ll k_0\left|\frac{\p E}{\p x}\right| \quad \text{, } \left |\frac{\p^2 \eta}{\p t^2}\right | \ll \omega_0^2 \left| \eta_{21}\right| \quad \text{, } \omega_0 \left| \frac{\p \eta_{21}}{\p t}\right| \ll  \omega_0^2\left|\eta_{21}\right|.
	\end{align}
	Expanding Eq. (\ref{eq:waveqn}) we obtain
	\begin{align}
	LHS &= \frac{1}{2} \frac{c^2}{n_{THz}^2} \left(\frac{\p^2 E}{\p x^2} +2ik_0 \frac{\p E}{\p x} -k_0^2 E\right)e^{i(k_0x-\omega_0t)} - \frac{1}{2}\left(\frac{\p^2 E}{\p t^2} -2i\omega_0 \frac{\p E}{\p t} -\omega_0^2 E\right)e^{i(k_0x-\omega_0t)} + c.c. \nonumber \\
	RHS &= -\frac{N\Gamma\mu}{\epsilon_0 n_{THz}^2} \left(\frac{\p^2 \eta_{21}}{\p t^2} -2i\omega_0 \frac{\p \eta_{21}}{\p t} -\omega_0^2. \eta_{21}\right)e^{i(k_0x-\omega_0t)}+c.c.
	\end{align}
	Now, if we apply the SVEA approximation, i.e. Eq. (\ref{eq:SVEA}), and compare the coefficients in front of the exponents we get
	\begin{align}
	\label{eq:almostdone}
	\frac{c^2}{n_{THz}^2}ik_0 \frac{\p E}{\p x}+i\omega_0 \frac{\p E}{\p t} = \frac{N\Gamma\mu\omega_0^2}{\epsilon_0 n_{THz}^2}\eta_{21}.
	\end{align}
	Lastly, we divide Eq. (\ref{eq:almostdone}) by $i\omega_0$ and acknowledge that we have set $k_0 = \omega_0 n_{THz}/c$ to get
	\begin{align}
	\label{eq:almostdone2}
	\frac{c}{n_{THz}} \frac{\p E}{\p x}+ \frac{\p E}{\p t} = -i\frac{N\Gamma\mu\omega_0}{\epsilon_0 n_{THz}^2}\eta_{21},
	\end{align}
	or equivalently
	\begin{align}
	\label{eq:almostdone3}
	\frac{\p E}{\p x}+ \frac{n_{THz}}{c} \frac{\p E}{\p t} = -i\frac{N\Gamma\mu\omega_0}{\epsilon_0 c n_{THz}}\eta_{21}.
	\end{align}
	
	\section{Discretization}
	
	Equation (\ref{eq:almostdone3}) is a first order hyperbolic partial differential equation which, although might seem easy at first sight, is non-trivial to solve numerically. From the area of computational fluid dynamics
	\cite{wesseling2009principles}, it is known that a simple central differences
	discretization scheme for Eq. (\ref{eq:almostdone3}) will be highly unstable due to
	the introduction of strong \emph{numerical} dispersion near sharp edges or
	discontinuities of the solution. A finite difference scheme that does not
	generate such spurious oscillations is called monotonicity preserving
	\cite{wesseling2009principles} and its usage is essential for the correct
	interpretation of simulation results, especially when one tries to quantify
	the amount of \emph{physical} dispersion present. Without getting too much
	into detail, we present a second order linear finite difference discretization
	scheme, possessing the monotonicity preserving property, for the model equation
	\begin{equation}
	\label{eq:model-equation}
	\frac{\partial F}{\partial t}+ \frac{c}{n_{THz}}\frac{\partial F}{\partial
		x}=\eta(x,t)+kF,%
	\end{equation}
	where $k<0$ can incorporate arbitrary losses, and the rest of the terms can be renormalized in a straightforward way to obtain Eq. (\ref{eq:almostdone3}).
	
	We take an equidistant spatio-temporal grid with grid size $\Delta x$ and time
	step $\Delta t$ and set the values of the grid variables at spatial point
	$x_{m}=m\Delta x$ and time $t_{n}=n\Delta t$ as $F(m,n)$ and $\eta(m,n)$ denotes the corresponding source term. The time stepping scheme we use is based on a second order upwind discretization, first introduced by Risken and Nummedal \cite{risken1968self}, and is given by
	\begin{align}
	\label{eq:numerics}
	F(m,n+1) &  =F(m-1,n)+\Delta t\left[ \eta(m,n)+kF(m,n)\right]  \nonumber\\
	&  +\frac{\Delta t^{2}}{2}\left\{  \left[  \frac{\partial \eta}{\partial
		t}\right]_{m}^{n}- \frac{c}{n_{THz}}\left[  \frac{\partial \eta}{\partial x}\right]
	_{m}^{n}-2k\frac{c}{n_{THz}}\left[  \frac{\partial F}{\partial x}\right]_{m}%
	^{n}+k\eta(m,n)+k^{2}F(m,n)\right\}  ,
	\end{align}
	where the \textbf{time step is chosen as $\Delta t=\Delta xn_{THz}/c$}, with $c/n_{THz}$
	being the velocity of light in the medium. The evaluation of the time
	derivative of $\eta(x,t)$ can be computed analytically from the density matrix
	equations. The terms in rectangular brackets, $\left[
	\partial \eta/\partial x\right]_{m}^{n}$ and $\left[  \partial F/\partial x\right]  _{m}^{n}$, can be computed via a simple first order forward
	finite difference scheme (since we assume uni-directional propagation in the positive $x$-direction), which due to the prefactor of $\delta t^2$ will preserve the second order accuracy of the scheme.  
	
	\section{Maxwell-Bloch equations}
	\subsection{Ring Cavity}
	For a ring cavity we have only unidirectional propagation and thus the system of equations is very simple.  
	\begin{align}
	& \frac{\p E}{\p x}+ \frac{n_{THz}}{c} \frac{\p E}{\p t} = -i\frac{N\Gamma\mu\omega_0}{\epsilon_0 c n_{THz}}\eta_{21}-\frac{l}{2}E.
	\\
	& \partial_t {\rho_{2,2}(t)} = i\frac{ \mu }{2 \hbar} \Big ( E^* \eta_{21} - E^*\eta_{21} \Big) -\frac{\rho_{2,2}-\rho_{2,2}^{eq}}{T_1}\text{  ,}
	\\
	& \partial_t {\rho_{1,1}(t)} = - i\frac{ \mu }{2 \hbar} \Big ( E^* \eta_{21} - E^*\eta_{21} \Big) -\frac{\rho_{1,1}-\rho_{1,1}^{eq}}{T_1}
	\\
	& d_t \eta_{21} = -i(\omega_{21}-\omega_0)+i\frac{ \mu}{ 2 \hbar} E(\rho_{22}-\rho_{11}) - \frac{\eta_{21}}{T2} \text{  ,}
	\end{align}
	
	\subsection{Fabry-Perot cavity}
	
	For a Fabry-Perot cavity we need to allow for both forward and backward travelling components of the field. The interference between those counter-propagating waves will induce intensity grating, which in turn will induce a population grating, commonly referred to as the spatial hole burning (SHB) effect. Due to the relatively slow carrier diffusion as compared to the life-times in QCLs, SHB cannot be neglected. Within the rotating wave approximation SHB is usually modelled only to first order by making the ansatz 
	\begin{align}
	\rho_{jj}(t) = \rho_{jj}^{0} + \rho_{jj}^{+}e^{2ikx}+\rho_{jj}^{-}e^{-2ikx}, 
	\end{align}
	where $\rho_{jj}^{0}$ can be interpreted as population averages, and $\rho_{jj}^{+}=(\rho_{jj}^{-})^{\ast}$ as the amplitudes of the inversion grating. Naturally for the electric field and the polarization the following ansatz also applies 
	\begin{align}
	E_{z}(x,t) &=\frac{1}{2}\left( E_{+}(x,t)e^{\mathrm{i}(k_{0}x-\omega_{0}t)} +E_{-}(x,t)e^{-\mathrm{i}(k_{0}x+\omega_{0}t)}  +c.c\right)  , \label{eq:e-ansatz} \\
	\rho_{21}(x,t)  &  =\eta_{21}^{+}(x,t)e^{  \mathrm{i}(k_{0}x-\omega_{0}t)}  +\eta_{21}^{-}(x,t)e^{-\mathrm{i}(k_{0}x+\omega_{0}t)}  ,\label{eq:21ansatz}
	\end{align}
	
	Then the density matrix equations become 
	\begin{align}
	\frac{d\rho_{22}^{0}}{dt} &= \mathrm{i}\frac{\mu}{2\hslash}\left(  E_{-}^{\ast}\eta_{21}^{-}+E_{+}^{\ast}\eta_{21}^{+}-c.c.\right) -\frac{\rho_{2,2}^{0}-\rho_{2,2}^{eq}}{T_1} \\
	\frac{d\rho_{22}^{+}}{dt} &= \mathrm{i}\frac{\mu}{2\hslash}\left[  E_{-}^{\ast}\eta_{21}^{+}-E_{+}(\eta_{21}^{-})^{\ast}\right] - \left( \frac{1}{T_1}+4k_{0}^{2}D\right)  \rho_{22}^{+},\label{eq:rtpop3grating}\\
	\frac{d\rho_{11}^{0}}{dt} &=-\mathrm{i}\frac{\mu}{2\hslash}\left(E_{-}^{\ast}\eta_{21}^{-}+E_{+}^{\ast}\eta_{21}^{+}-c.c.\right) -\frac{\rho_{1,1}^{0}-\rho_{1,1}^{eq}}{T_1} \\
	\frac{d\rho_{11}^{+}}{dt} &=-\mathrm{i}\frac{\mu}{2\hslash}\left[E_{-}^{\ast}\eta_{21}^{+}-E_{+}(\eta_{21}^{-})^{\ast}\right] -\left(  \frac{1}{T_1}+4k_{0}^{2}D\right) \rho_{11}^{+}, \label{eq:rtpop2grating} \\
	\frac{d\eta_{21}^{\pm}}{dt} & = -\mathrm{i}\left(  \omega_{0}-\omega_{21}\right) \eta_{21}^{\pm}+\mathrm{i}\frac{\mu}{2\hslash}\left[  E_{\pm}(\rho_{22}^{0}-\rho_{11}^{0})+E_{\mp}(\rho_{22}^{\pm}-\rho_{11}^{\pm})\right]-\frac{1}{T_2}\eta_{21}^{\pm},
	\end{align}
	where D is the diffusion constant, $k_0$ is the wave number and the $^{\ast}$ denotes the complex conjugate.
	
	The propagation equations are
	\begin{equation}
	\frac{n_{THz}}{c}\frac{\partial E_{\pm}}{\partial {t}}\pm\frac{E_{\pm}}{\partial {x}}=-i\frac{N\Gamma\mu\omega_0}{\epsilon_0 c n_{THz}}\eta_{21}^{\pm}-\frac{l}{2}E_{\pm
	}, \label{eq:rtwave}%
	\end{equation}	
	
	
	
	
	\bibliography{bib_resources.bib}
\end{document}

